CREATE DATABASE ApartmentManagement;
USE ApartmentManagement;

SET DATEFORMAT dmy;

CREATE TABLE NHANVIEN(
	maNhanVien char(8) NOT NULL CONSTRAINT pk_NHANVIEN PRIMARY KEY,
	maKhau char(30) NOT NULL,
	hoTen nvarchar(30) NOT NULL,
	ngaySinh DATE NOT NULL DEFAULT GETDATE(),
	gioiTinh BIT NOT NULL,
	soDienThoai CHAR(10) NOT NULL,
	diaChi NVARCHAR(100) NOT NULL,
	soCMND CHAR(12) NOT NULL,
	luongCung bigint NOT NULL,
	vaiTro bit NOT NULL
);

select * from nhanvien where maNhanVien = '19048690' and maKhau = '12345';
INSERT INTO NHANVIEN VALUES('admin','admin', 'admin', '01-12-1990', 1, '0123456789', 'Viet Nam', '123456789', 25000, 1);
INSERT INTO NHANVIEN VALUES('tungbt','tungbt', 'Tùng BT.', '19-4-1998', 1, '0987733238', 'Tân Châu, An Giang', '323833789', 25000, 1);
INSERT INTO NHANVIEN VALUES('trungnm','trungnm', 'Trung Ngô', '25-6-1999', 1, '0986775750', 'Chợ Mới, An Giang', '323877569', 20000, 1);
INSERT INTO NHANVIEN VALUES('19048690','12345', 'Nhân viên', '19-4-1998', 1, '0987733238', 'Tân Châu, An Giang', '323833789',12000, 0);
INSERT INTO NHANVIEN VALUES('19048691','12345', 'Nhân viên', '19-4-1998', 0, '0987733238', 'Tân Châu, An Giang', '323833789', 10000, 0);
INSERT INTO NHANVIEN VALUES('19048692','12345', 'Nhân viên', '19-4-1998', 0, '0987733238', 'Tân Châu, An Giang', '323833789', 13000, 0);
INSERT INTO NHANVIEN VALUES('19048693','12345', 'Nhân viên', '19-4-1998', 0, '0987733238', 'Tân Châu, An Giang', '323833789', 8000, 0);
INSERT INTO NHANVIEN VALUES('19048694','12345', 'Nhân viên', '19-4-1998', 1, '0987733238', 'Tân Châu, An Giang', '323833789', 6500, 0);
-------
select * from NHANVIEN;
delete NHANVIEN where maNhanVien='C1904869';

CREATE TABLE KHUCANHO(
      maKhu CHAR(3) CONSTRAINT pk_KHUCANHO PRIMARY KEY ,
      tenKhu NVARCHAR(30) NOT NULL,
      soTang INT NOT NULL DEFAULT 1,
      soCanHo INT NOT NULL DEFAULT 1,
      diaChi NVARCHAR(100) NOT NULL,
);

insert into KHUCANHO values('HHH', 'Khu H', 12, 60, N'Cần Thơ');
insert into KHUCANHO values('III', 'Khu I', 19, 88, N'Cần Thơ');
insert into KHUCANHO values('JJJ', 'Khu J', 13, 63, N'Cần Thơ');
insert into KHUCANHO values('KKK', 'Khu K', 05, 30, N'Cần Thơ');
insert into KHUCANHO values('LLL', 'Khu L', 10, 50, N'Cần Thơ');
insert into KHUCANHO values('MMM', 'Khu M', 14, 53, N'Cần Thơ');
insert into KHUCANHO values('NNN', 'Khu N', 15, 75, N'Cần Thơ');
insert into KHUCANHO values('UUU', 'Khu U', 12, 54, N'Cần Thơ');
select * from KHUCANHO;
--drop table KHUCANHO; -- xoá 5
UPDATE KHUCANHO SET tenKhu='Khu CS', soTang=4, soCanHo=12,diaChi='Gia Dinh' where maKhu='CCD';

CREATE TABLE KHACHHANG(
      maKhachHang CHAR(6) CONSTRAINT pk_KHACHHANG PRIMARY KEY,
      tenKhachHang NVARCHAR(30) NOT NULL,
      ngaySinh DATE NOT NULL DEFAULT GETDATE(),
      gioiTinh BIT NOT NULL DEFAULT 0,
      soDienThoai CHAR(10) NOT NULL,
      soCMND CHAR(12) NOT NULL,
      queQuan NVARCHAR(100) NOT NULL
);
select * from KHACHHANG;
INSERT INTO KHACHHANG VALUES('100100',N'Tùng Bùi','19-4-1998',1,'0987733238','323832338',N'An Giang');
INSERT INTO KHACHHANG VALUES('100101',N'Trung Ngô','18-5-1996',1,'0936256022','332562329',N'Đồng Tháp');
INSERT INTO KHACHHANG VALUES('100102',N'Huỳnh Nhi','19-4-1994',0,'0988456741','323522011',N'Hậu Giang');
INSERT INTO KHACHHANG VALUES('100103',N'Trần Long','19-4-1999',1,'0987568230','321158436',N'Sóc Trăng');
INSERT INTO KHACHHANG VALUES('100104',N'Cao Hùng','19-4-2000',1,'0987725012','302531036',N'Bạc Liêu');
INSERT INTO KHACHHANG VALUES('100105',N'Lý Đứcc','19-4-1985',1,'0945332011','253658974',N'Phú Yên');
INSERT INTO KHACHHANG VALUES('100106',N'An Vy','19-4-1975',0,'0949000112','154755325',N'Nam Định');
INSERT INTO KHACHHANG VALUES('100107',N'Long Cao','12-4-1992',1,'0987733238','323832338',N'An Giang');
INSERT INTO KHACHHANG VALUES('100108',N'Nguyễn Tuấn','19-5-1998',1,'0987733238','323832338',N'Cần Thơ');
INSERT INTO KHACHHANG VALUES('100109',N'Trần Minh','21-8-1989',1,'0987733238','323832338',N'Vĩnh Long');
INSERT INTO KHACHHANG VALUES('100110',N'Mỹ Nhân','25-12-1986',0,'0987733238','323832338',N'Hồ Chí Minh');
INSERT INTO KHACHHANG VALUES('100111',N'Phan Quân','02-11-1990',1,'0987733238','323832338',N'Bình Phước');
INSERT INTO KHACHHANG VALUES('100112',N'Lê Uyên','14-5-1994',0,'0987733238','323832338',N'Bình Dương');
INSERT INTO KHACHHANG VALUES('100113',N'Thái Vũ','16-7-1999',1,'0987733238','323832338',N'Kiên Giang');
INSERT INTO KHACHHANG VALUES('100114',N'Vinh Râu','18-6-2000',1,'0987733238','323832338',N'An Giang');
INSERT INTO KHACHHANG VALUES('100115',N'Đỗ Đạt','11-7-1999',1,'0987733238','323832338',N'An Giang');
INSERT INTO KHACHHANG VALUES('100116',N'Vũ Uyên','17-1-1994',0,'0987733238','323832338',N'Tà Keo');
INSERT INTO KHACHHANG VALUES('100117',N'Hoàng Oanh','16-2-1993',0,'0987733238','323832338',N'Hà Nội');
INSERT INTO KHACHHANG VALUES('100118',N'Nguyễn Lan','23-3-1985',0,'0987733238','323832338',N'Đà Nẵng');
INSERT INTO KHACHHANG VALUES('100119',N'Lâm Huệ','26-1-1980',0,'0987733238','323832338',N'Huế');
INSERT INTO KHACHHANG VALUES('100120',N'Bùi Tuấn','19-10-1979',1,'0987733238','323832338',N'Nghệ An');
INSERT INTO KHACHHANG VALUES('100121',N'Lý Hùng','25-12-1986',1,'0987733238','323832338',N'Bắc Ninh');
INSERT INTO KHACHHANG VALUES('100122',N'Đinh Loan','02-11-1956',0,'0987733238','323832338',N'Vũng Tàu');
INSERT INTO KHACHHANG VALUES('100123',N'Thái Ngọc','19-6-1997',0,'0987733238','323832338',N'Khánh Hoà');
INSERT INTO KHACHHANG VALUES('100124',N'Tần Quốc','17-8-1999',1,'0987733238','323832338',N'Nam Định');
INSERT INTO KHACHHANG VALUES('100125',N'Ngô Ái','03-9-1998',0,'0987733238','323832338',N'Gia Lai');
INSERT INTO KHACHHANG VALUES('100126',N'Trần Gia','09-4-1990',1,'0987733238','323832338',N'Lạng Sơn');
INSERT INTO KHACHHANG VALUES('100127',N'Lại Đăng','15-5-1992',1,'0987733238','323832338',N'An Giang');
INSERT INTO KHACHHANG VALUES('100128',N'Nhã Kỳ','17-6-1993',0,'0987733238','323832338',N'Đồng Tháp');
INSERT INTO KHACHHANG VALUES('100129',N'Lâm Anh','14-7-1991',0,'0987733238','323832338',N'Long An');
INSERT INTO KHACHHANG VALUES('100130',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');

INSERT INTO KHACHHANG VALUES('100131',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100132',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100133',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100134',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100135',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100136',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100137',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100138',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100139',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');

INSERT INTO KHACHHANG VALUES('100140',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100141',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100142',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100143',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100144',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100145',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100146',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100147',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100148',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100149',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');
INSERT INTO KHACHHANG VALUES('100150',N'Quách Hương','11-12-1988',0,'0987733238','323832338',N'Tây Ninh');

--drop table KHACHHANG; -- xoá (4)
select * from KHACHHANG;
SELECT * FROM KHACHHANG WHERE gioiTinh='1';

CREATE TABLE CANHO(
      maCanHo CHAR(6) CONSTRAINT pk_CANHO PRIMARY KEY,
      dienTich FLOAT NOT NULL DEFAULT 50,
      giaBan BIGINT NOT NULL,
      trangThai BIT NOT NULL DEFAULT 0,
      soPhong INT NOT NULL DEFAULT 5,
      maKhu CHAR(3) NOT NULL CONSTRAINT fk2_CANHO 
	  FOREIGN KEY REFERENCES dbo.KHUCANHO (maKhu) ON DELETE CASCADE ON UPDATE CASCADE --  (AA -> ZZ)
);

--drop table CANHO; -- xoá (3)
select * from CANHO;
INSERT INTO CANHO VALUES('001100',50.0,100,'1',2,'AAA');
INSERT INTO CANHO VALUES('001160',55.0,200,'0',2,'AAA');
INSERT INTO CANHO VALUES('001120',60.0,150,'0',2,'AAA');
INSERT INTO CANHO VALUES('001110',70.0,500,'1',2,'AAA');

INSERT INTO CANHO VALUES('002100',55.0,700,'0',2,'BBB');
INSERT INTO CANHO VALUES('002130',56.0,1200,'1',2,'BBB');
INSERT INTO CANHO VALUES('002200',57.0,1000,'0',2,'BBB');
INSERT INTO CANHO VALUES('002110',59.0,300,'1',2,'BBB');

INSERT INTO CANHO VALUES('003100',45.0,1600,'0',2,'CCC');
INSERT INTO CANHO VALUES('003120',30.0,1300,'0',2,'CCC');
INSERT INTO CANHO VALUES('003110',25.0,600,'1',2,'CCC');

INSERT INTO CANHO VALUES('004100',20.0,350,'1',2,'DDD');
INSERT INTO CANHO VALUES('004130',50.0,1200,'0',2,'DDD');
INSERT INTO CANHO VALUES('004200',62.0,1800,'1',2,'DDD');

INSERT INTO CANHO VALUES('005100',33.0,600,'1',2,'EEE');
INSERT INTO CANHO VALUES('005200',46.0,1300,'0',2,'EEE');
INSERT INTO CANHO VALUES('005300',61.0,12000,'0',2,'EEE');

INSERT INTO CANHO VALUES('006100',15.0,650,'0',2,'FFF');
INSERT INTO CANHO VALUES('006100',55.0,1350,'1',2,'FFF');
INSERT INTO CANHO VALUES('006100',70.0,15000,'1',2,'FFF');

INSERT INTO CANHO VALUES('007100',50.0,900,'1',2,'GGG');
INSERT INTO CANHO VALUES('007200',56.0,1200,'0',2,'GGG');
INSERT INTO CANHO VALUES('007300',63.0,2500,'1',2,'GGG');

INSERT INTO CANHO VALUES('008500',80.0,35000,'1',2,'HHH');
INSERT INTO CANHO VALUES('008400',65.0,15000,'1',2,'HHH');
INSERT INTO CANHO VALUES('008150',59.0,7500,'0',2,'HHH');

INSERT INTO CANHO VALUES('009100',40.0,350,'1',2,'III');
INSERT INTO CANHO VALUES('009120',51.0,720,'0',2,'III');
INSERT INTO CANHO VALUES('009200',38.0,450,'1',2,'III');

INSERT INTO CANHO VALUES('010100',52.0,1000,'0',2,'JJJ');
INSERT INTO CANHO VALUES('010200',55.0,1300,'1',2,'JJJ');
INSERT INTO CANHO VALUES('010300',63.0,2200,'1',2,'JJJ');

INSERT INTO CANHO VALUES('011100',43.0,800,'1',2,'KKK');
INSERT INTO CANHO VALUES('011200',58.0,2400,'0',2,'KKK');
INSERT INTO CANHO VALUES('011110',61.0,3000,'1',2,'KKK');

INSERT INTO CANHO VALUES('012100',58.0,1500,'0',2,'LLL');
INSERT INTO CANHO VALUES('012500',65.0,6000,'1',2,'LLL');
INSERT INTO CANHO VALUES('012300',68.0,8000,'1',2,'LLL');

INSERT INTO CANHO VALUES('013100',66.0,9000,'1',2,'MMM');
INSERT INTO CANHO VALUES('013300',52.0,5200,'1',2,'MMM');
INSERT INTO CANHO VALUES('013200',30.0,2500,'1',2,'MMM');

INSERT INTO CANHO VALUES('014100',50.0,1000,'1',2,'NNN');
INSERT INTO CANHO VALUES('014200',55.0,1750,'0',2,'NNN');
INSERT INTO CANHO VALUES('014300',69.0,13500,'0',2,'NNN');

INSERT INTO CANHO VALUES('015100',72.0,6400,'1',2,'UUU');
INSERT INTO CANHO VALUES('015200',55.0,1250,'1',2,'UUU');
INSERT INTO CANHO VALUES('015500',66.0,9999,'1',2,'UUU');


CREATE TABLE HOPDONG(
      maHopDong CHAR(10) NOT NULL CONSTRAINT pk_HOPDONG PRIMARY KEY,
	  maKhachHang CHAR(6) NOT NULL CONSTRAINT fk1_HOPDONG FOREIGN KEY REFERENCES dbo.KHACHHANG (maKhachHang),
	  maNhanVien char(8) NOT NULL CONSTRAINT fk_NHANVIEN FOREIGN KEY REFERENCES dbo.NHANVIEN(maNhanVien),
	  maCanHo CHAR(6) NOT NULL CONSTRAINT fk2_HOPDONG
      FOREIGN KEY REFERENCES dbo.CANHO (maCanHo) ON DELETE CASCADE ON UPDATE CASCADE,
      ngayGiaoDich DATE NOT NULL DEFAULT GETDATE()
);

select * from HOPDONG;
--drop table HOPDONG; -- xoá (1)

INSERT INTO HOPDONG VALUES('1900191200','100100','19001900','001100','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191201','100101','19001901','001110','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191202','100102','19001902','002110','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191203','100103','19001903','002130','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191204','100104','19001904','003110','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191205','100105','19001905','004110','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191206','100106','19001906','004200','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191207','100107','19001907','005100','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191208','100108','19001909','007100','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191209','100109','19001900','00700','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191210','100110','19001905','008400','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191211','100111','19001908','008500','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191212','100112','19001907','010200','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191213','100115','19001905','010300','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191214','100113','19001904','011100','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191215','100114','19001905','002300','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191216','100116','19001908','012500','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191217','100117','19001901','013100','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191218','100118','19001902','013200','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191219','100119','19001903','013300','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191220','100120','19001905','014100','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191221','100121','19001908','015100','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191222','100122','19001909','015200','2019-11-02');
INSERT INTO HOPDONG VALUES('1900191223','100121','19001910','015500','2019-11-02');



CREATE TABLE DIENNUOC(
	maCanHo CHAR(6) NOT NULL CONSTRAINT fk_DIENNUOC 
	  FOREIGN KEY REFERENCES dbo.CANHO (maCanHo) ON DELETE CASCADE ON UPDATE CASCADE,
	  eChiSoCu int NOT NULL DEFAULT 0,
	  eChiSoMoi int NOT NULL DEFAULT 0,
	  wChiSoCu int NOT NULL DEFAULT 0,
	  wChiSoMoi int NOT NULL DEFAULT 0,
	  primary key (maCanHo)
)